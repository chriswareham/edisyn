/***
    Copyright 2021 by Bryan Hoyle
    Licensed under the Apache License version 2.0
*/

package edisyn.nn;

public class SELU implements Layer 
    {
    private static double ALPHA = 1.6732632423543772848170429916717;
    private static double LAMBDA = 1.0507009873554804934193349852946;
    private static double selu(double x) 
        {
        if (x > 0)
            {
            return LAMBDA*x;
            }
        return LAMBDA*(ALPHA * Math.exp(x) - ALPHA);
        }
        
    public double[] feed(double[] vec)
        {
        double[] out = new double[vec.length]; 
        for(int i = 0; i < vec.length; i++)
            {
            out[i] = selu(vec[i]);
            }
        return out;
        }
    public static Layer readFromString(String str)
        {
        return new SELU();
        }
    }

/*
  tensor([ 4.4917, -0.2929,  1.8916, -0.9913, -2.6206,  3.8967,  5.5122, -6.4022,
  -0.2887,  2.6069,  0.5497, -0.0519, -0.1549, -0.3303, -3.3185, -2.9537,
  1.9305, -3.0986, -0.4077, -2.7228, -3.1449,  1.4059, -4.8677, -1.7671,
  -5.1095,  1.1643,  2.1688, -3.2153, -2.5289, -0.7424,  0.4860, -1.0067,
  -3.0321, -0.6876,  1.1455,  2.8518, -3.7724, -1.3941, -2.2390,  2.5136,
  1.2042, -1.0083, -3.6883,  1.2699, -5.0092, -1.0828,  4.5882,  1.2829,
  1.3916,  1.0417,  3.6030,  3.6006, -0.8883, -1.4631, -2.4072, -1.1538,
  -2.2066, -3.9636, -3.3209,  0.3761,  3.6274, -1.9066, -3.2753,  0.8116,
  -1.0395, -1.9284, -2.0537, -2.1890, -5.1313,  3.3424,  3.4812,  1.6912,
  0.3816, -1.2609,  0.0639, -2.7045,  4.1155,  1.4786,  0.0249, -2.6010,
  -0.8599, -4.6521, -4.0689,  2.5999, -2.2677, -4.4182,  1.8956, -1.8531,
  2.8576,  3.1566, -4.0607,  1.9360,  0.6210,  3.7691, -2.7853, -1.1815,
  0.7746,  0.8542, -0.1691,  4.5954,  0.9293, -1.0890,  1.0690,  2.9639,
  0.2414,  0.6419, -3.1738, -4.5061, -2.7505, -0.7720, -0.6260,  1.6797,
  0.2538,  3.2681,  0.2608, -2.9915, -0.3043,  2.2785, -5.1010, -3.5849,
  1.7974, -2.1668, -2.7384,  1.0776,  4.4675, -4.0407,  0.5016,  0.5652],
  grad_fn=<AddBackward0>)

*/
